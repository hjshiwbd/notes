[General]
SyntaxVersion=2
BeginHotkey=113
BeginHotkeyMod=4
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=114
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=efe8ad2f-69b9-4b1c-943e-ad6513a61688
Description=wow-识别颜色用治疗技能
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=2
QUI=
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
UEsDBBQAAgAIAKCK3lgrfYSh1wQAAAg2AAAJABEAVUlQYWNrYWdlVVQNAAcclIFmHJSBZhyUgWbtWstvE0cY/9ZOiJ0E50HihASKeYRHeD8KtNCqGIFACg8Rt4dKIJkQIGLjRHZC0/43HBEXkMq5x1YI0Z45FQSXol564EbMb3Zn40mUiP1mJhlc+Yu+jLPx7G9mvve3m6SQ/vqz6+8HTwZe0RL6lpI0X03TOuWaJzmgTqKE/Hu+Wq1Gl6sNqiv6AG6SMhSybga3gNPgFLgVvB7cBm4HZ0LRUwe4C7wB3A3uAWfBveA+8EZwv7zvfOOYP1u6RlP4maEcnaMSxjL9TBzKQmOie3mf+O7jf5++ffHspZfE5+8y4bXv6SIdIn1KkedF+H2fwI1G9X9nqUAjBitohQeM8Js18As472kap8tUpEmMXOqmRLD/Lul7485rkmNkn/9nbtDKdH6qPGlgfiTmHzaY75EZmc43pV8fP39rsn+Gya7KfF2/U/N/iUU5X1yZRb5SRJ0i3SRfcw0Z+L82mafExU8o/u8HmqAKWHcFnRr7Tyr414BapFt0BefgM2Nv5P/b5T3j4jcp+AXgzyHuG8jf4+6/WZH/WWQfPrisuZIeDfx1yv5r+HnIYYzu8fGDfLmDcf4tS+Q/Znj+Ij9PMfBTFObwKl2HUbyn+qMWx/jvlz/zICxdGs2NFkuV3Oh4eeL2KuEPPbphNP9HeJ4y/M84fuuQ8L+90qbi6l9a0f8R2B7f6hbrf6e8X1z81mXtfxTruItz4EXDfth/VAPHxW9T8M8g+58OYkAZXMIaeFEoi/2nKazL4+K3K/jnsfeSmf9hxz/hr04v7N9H9L2DNYhzL+n4fzZ+ZpH8izj/GaxBnEM+kEMUCWq6sTLtxvlnqdb3ioPfoeDng/uH9hcHbxn983qY+J0Kvqn/MM0/TeliaXp2Jj81ZzpfN4ev9/qlAM2fCXJfHe0L/A/b/roU/bsK/Dmg+8jCdSijgd+9BF/kX7PYt04Xpl8DX+2Xh/0n/QqylTxP1DP7wQMrfGct+k87KX78EfEyJT+7qD+Fv0zLzzbqzxzGLYz995LV+tPbinEXAz9LduvPQQp7/XHx+8ht/SnW2rJgf8b1J1v/NpLd+nMTxh2M8x9Q8J+9+ePdb/+ZdLDMyDR/yEtZvpY2wCXX8TfpGN9G/2Ebxs0M/RukWv/BQv3Jtr9NZLf+HJI2HRd/M9mtP4cx7mHgf0F268/dGLcz8LeQ2/ozR27rz62k5p9FxP8K/STrQC51a+BvU/Bd969ck2n9O/z0rtH8wQcFp/u/hMrHD/ofI+ASOwcV/XfhT/Yx7H+7on+XA72fhBX42v0Prv7vUPAvAO++dvcl9H97idd/GVri/8Ygg8oa1t87FXwRdcoBsi+7X6vv/3aRGv9E/XtEW3/V9y9WeotjLerf0wz9F/GyeUH/177+FblC9F7fSPHmuG/gP4L5BuVDvffPnvzz+0OT6sl1/9VG/+M4xi8Z+j9MdvsfJ0i8rxoffy/Z7X8I+R9g4O8jt/2P/eT2+fsBstv/ENHja8b5HyS7z99PYjzKwD9Ebuvfw8r+RS9WPI/8StoFlxLkllz3T+q9frLR/zglbSqu/h0hq/2PwP98w8A/Snb7H8ek/cTFP0Zu+x8iVrvsfxwnNf6F516BFIrBMzjeGnSev51YJP9Z4E1B+yboF738n41/UsG3QVz8BjUooo9QSwECFwsUAAIACACgit5YK32EodcEAAAINgAACQAJAAAAAAAAAAAAAIAAAAAAVUlQYWNrYWdlVVQFAAcclIFmUEsFBgAAAAABAAEAQAAAAA8FAAAAAA==


[Script]
/*
颜色1, 十进制(228, 142, 76), 十六进制(E48E4C)
颜色2, 十进制(102, 205, 170), 十六进制(66CDAA)
颜色3, 十进制(255, 182, 193), 十六进制(FFB6C1)
颜色4, 十进制(123, 104, 238), 十六进制(7B68EE)
颜色5, 十进制(240, 128, 128), 十六进制(F08080)
颜色6, 十进制(173, 216, 230), 十六进制(A9DCE6)
颜色7, 十进制(32, 178, 170), 十六进制(20B2AA)
颜色8, 十进制(0, 255, 127), 十六进制(00FF7F)
颜色9, 十进制(255, 255, 0), 十六进制(FFFF00)
颜色10, 十进制(135, 206, 250), 十六进制(87CEFA)
颜色11, 十进制(255, 99, 71), 十六进制(FF6347)
颜色12, 十进制(144, 238, 144), 十六进制(90EE90)
颜色13, 十进制(238, 130, 238), 十六进制(EE82EE)
颜色14, 十进制(255, 69, 0), 十六进制(FF4500)
颜色15, 十进制(0, 191, 255), 十六进制(00BFFF)
颜色16, 十进制(221, 160, 221), 十六进制(DDA0DD)
颜色17, 十进制(152, 251, 152), 十六进制(98FB98)
颜色18, 十进制(255, 20, 147), 十六进制(FF1493)
颜色19, 十进制(72, 61, 139), 十六进制(483D8B)
颜色20, 十进制(175, 238, 238), 十六进制(AFEEEE)
颜色21, 十进制(139, 69, 19), 十六进制(8B4513)
颜色22, 十进制(244, 164, 96), 十六进制(F4A460)
颜色23, 十进制(255, 105, 180), 十六进制(FF69B4)
颜色24, 十进制(0, 255, 255), 十六进制(00FFFF)
颜色25, 十进制(60, 179, 113), 十六进制(3CB371)
颜色26, 十进制(210, 105, 30), 十六进制(D2691E)
颜色27, 十进制(124, 252, 0), 十六进制(7CFC00)
颜色28, 十进制(255, 228, 181), 十六进制(FFE4B5)
颜色29, 十进制(147, 112, 219), 十六进制(9370DB)
颜色30, 十进制(255, 222, 173), 十六进制(FFDEAD)
颜色31, 十进制(50, 205, 50), 十六进制(32CD32)
颜色32, 十进制(255, 127, 80), 十六进制(FF7F50)
颜色33, 十进制(219, 112, 147), 十六进制(DB7093)
颜色34, 十进制(64, 224, 208), 十六进制(40E0D0)
颜色35, 十进制(255, 215, 0), 十六进制(FFD700)
颜色36, 十进制(210, 180, 140), 十六进制(D2B48C)
颜色37, 十进制(238, 232, 170), 十六进制(EEE8AA)
颜色38, 十进制(255, 165, 0), 十六进制(FFA500)
颜色39, 十进制(154, 205, 50), 十六进制(9ACD32)
颜色40, 十进制(255, 240, 245), 十六进制(FFF0F5)
颜色41, 十进制(144, 238, 144), 十六进制(90EE90)
颜色42, 十进制(95, 158, 160), 十六进制(5F9EA0)
颜色43, 十进制(128, 128, 128), 十六进制(808080)
颜色44, 十进制(0, 0, 128), 十六进制(000080)
颜色45, 十进制(173, 216, 230), 十六进制(A9DCE6)
颜色46, 十进制(105, 105, 105), 十六进制(696969)
颜色47, 十进制(255, 0, 255), 十六进制(FF00FF)
颜色48, 十进制(255, 250, 250), 十六进制(FFFAFA)
颜色49, 十进制(255, 235, 205), 十六进制(FFEBED)
颜色50, 十进制(70, 130, 180), 十六进制(4682B4)
*/

// 队伍框体第一个人的位置
initx = 537
inity = 408
// 队伍框体, 选择另一个人, 在x轴和y轴上进行的偏移量
offsetx = 42
offsety = 10

Dim colors

Set colors = CreateObject("Scripting.Dictionary")
colors("E48E4C") = array(initx, inity)
colors("66CDAA") = array(initx + offsetx * 1, inity)
colors("FFB6C1") = array(initx + offsetx * 2, inity)
colors("7B68EE") = array(initx + offsetx * 3, inity)
colors("F08080") = array(initx + offsetx * 4, inity)

// 游戏内颜色框体的位置
framex = 240
framey = 65


Do
	// 按键精灵获取的颜色, 转为rgb
	bgrcolor = Plugin.Color.GetPixelColor(framex, framey, 1)
	rgbcolor = gbrToRgb(bgrcolor)
	TracePrint "color bgr:" & bgrcolor & " ,rgb:" & rgbcolor
	//根据rgb获取队友位置
	position = colors(rgbcolor)
	If IsEmpty(position) Then 
	// 颜色对应队友位置没找到
    	TracePrint "position not found for " & rgbcolor
	Else 
		// 移动到位置, 点击技能
		TracePrint "move to " & position(0) & ", " & position(1)
    	MoveTo position(0), position(1)
    	LeftClick 1
    	Delay 100
    	// 点击技能 81=q 53=5
    	KeyPress 81, 1
	End If

	Delay 1000
Loop



Function click()
    x = initx
    y = inity
    For i = 1 To 15
        MoveTo x, y
        x = x + offsetx
        Delay 2000
    Next
    click = ""
End Function


// 字符串改变顺序, eg 123456 -> 563412
Function gbrToRgb(rgbcolor)
    Dim part1
    Dim part2
    Dim part3
    part1 = Left(rgbcolor, 2) ' 获取原字符串的1,2位
    part2 = Mid(rgbcolor, 3, 2)' 获取原字符串的3,4位
    part3 = Right(rgbcolor,2)' 获取原字符串的5,6位
    bgr = part3 & part2 & part1' 123456 -> 563412
    gbrToRgb = bgr
End Function
